#! /bin/bash


if [ -z "$1" ] ; then
	ARG="3"
else
	ARG="$1"
fi

if [ -z "$2" ] ; then
	FILTER=.
else
	# WARNING: this is used as a regex, so reckon with special behaviour for $^.*+?[]
	#
	# The brutal fix we employ here is to nuke everything at or after the first regex operator
	#
	#echo "$2" | sed -E -e 's/[ \t\r\n.*+\[\]\(\)?].*$//'    -- somehow barfs on the ] in the [..] set no matter what I try for escapes   :-S
	FILTER=$( echo "$2" | sed -E -e 'sX[.*+?()\[].*$XX' -e 's/-?lib$//i' )
fi


mknewproj() {
	libname=$( echo lib$1 | sed -E -e 's/^liblib/lib/i' -e 's/-?lib$//i' )
	if ! test -f $1.vcxproj ; then
		if ! test -f $libname.vcxproj ; then
			echo "mknewproj: $libname"
			cp -n libcpuid.vcxproj $libname.vcxproj
			node ./patch-vcxproj.js $libname.vcxproj
			./update-vcxproj.sh $libname.vcxproj
			./refill-vcxproj.sh $libname.vcxproj
		fi
	fi
}

mknewAPPproj() {
	libname=$1
	if ! test -f $libname.vcxproj ; then
		echo "mknewAPPproj: $libname"
		cp -n mutool.vcxproj $libname.vcxproj
		node ./patch-vcxproj.js $libname.vcxproj
		./update-vcxproj.sh $libname.vcxproj
		./refill-vcxproj.sh $libname.vcxproj
	fi
}

mknewMISCproj() {
	libname=$1
	if ! test -f $libname.vcxproj ; then
		echo "mknewMISCproj: $libname"
		cp -n collection-0.vcxproj $libname.vcxproj
		node ./patch-vcxproj.js $libname.vcxproj
		./update-vcxproj.sh $libname.vcxproj
		./refill-vcxproj.sh $libname.vcxproj
	fi
}

delnewproj() {
	libname=$1
	echo "delnewproj: $libname"
	rm ${libname}.vcxproj*   ${libname}_tests.vcxproj*   ${libname}_examples.vcxproj*   ${libname}_demos.vcxproj*   2> /dev/null
	libname=$( echo lib$1 | sed -e 's/^liblib/lib/i' -e 's/-?lib$//i' )
	rm ${libname}.vcxproj*   ${libname}_tests.vcxproj*   ${libname}_examples.vcxproj*   ${libname}_demos.vcxproj*   2> /dev/null
}

delnewproj2() {
	libname=$1
	echo "delnewproj: $libname"
	rm ${libname}.vcxproj*   ${libname}_tests.vcxproj*   ${libname}_examples.vcxproj*   2> /dev/null
}


# Anything that would, should or could (partly) serve as a library from our monolithic build perspective:

mylist=$(
(
grep -v '#' <<EOT

1D-RGB-color-gradient
2D-color-gradient-or-Procedural-texture
A-MNS_TemplateMatching
abseil-cpp
adaptiveqf
ADE-graph-management
AFLplusplus
agg
aho-corasick
aho_corasick
amd-fftw
annoy
ApprovalTestsCpp
arangodb
ArborX
argparse
armadillo
arrayfire
arrow
asio
asyncplusplus
asynqro
AudioFile
autodiff
avro
b2xtranslator
backward-cpp
baobzi
BaseMatrixOps
basez
BayerToRGB
BBHash
BCF-cuckoo-index
BehaviorTree.CPP
better-enums
bhtsne--Barnes-Hut-t-SNE
Bi-Sent2Vec
bibtool
bibutils
binary2strings
binary_search
binlog
BitFunnel
bitrush-index
bitsery
BLAKE3
blaze
blazingmq
BlingFire
blis
blitsort
bloom
bolt
boost
boost-url
boringssl
BoxFort
bplustree
breakpad
brotli
brown-cluster
brunsli
bustache
butteraugli
CacheLib
cachelot
caches
caffe
cairo
cairo-demos
capture-thread
Capture2Text
catboost
cctz
ccv-nnc
cdc-file-transfer
cel-cpp
cel-spec
cereal
ceres-solver
cfgpath
chewing_text_cud
chibi-scheme
chromium-snss-parse
cilantro
CImg
circlehash
civetweb
cjose
clBLAS
CLBlast
CLBlast-database
cld1-language-detect
cld2-language-detect
cld3-language-detect
cli11
clipp
Clipper2
clp
CLTune
Cmathtuts
cmph-hasher
CNTK
colm
color-util
colorm
ColorMagic
colormap-shaders
ColorSpace
comdb2-bdb
compact_enc_det
completesearch
concat
concurrencpp
concurrentqueue
config-cpp
continuable
coost
cpp-httplib
cpp-ipc
cpp-netlib
cpp-terminal
cppdap
cppflow
cppjieba
CppNumericalSolvers
cppsimhash
cpptoml
cppzmq
cpp_rest_sdk
cpuinfo
cpu_features
cpython
cqf
cr
crc32c
createprocess-windows
CRFpp
crfsuite
CRFsuite-extended
Criterion
CRoaring
crow
crumsort
cryptest
cryptlib
CryptSync
csv-parser
csvquote
csync2
CTCWordBeamSearch
CTPL-Thread-Pool
ctsa
cuckoo-index
cuckoofilter
curl
curl-impersonate
CurvatureFilter
cv-VanishingPoint
cvmatio
CxImage
cxxopts
cxxtest
Cysboard
darknet
dashing
datamash
date
datetimepp
dateutils
DBoW2
DBow3
dbscan
DCF-cuckoo-index
debugbreak
decision-tree
deepdetect
delegate
density
densityxx
design-patterns-cpp
detect-character-encoding
DGM-CRF
diffutils
Digital-Halftoning
directorywatcher
dirent
DiskANN

###### djvulibre -- already exists as libdjvu

dkm
dlfcn-win32
dlib
doctest
docxBox
doh
doxa
DP_means
dr_libs
dtl-diff-template-library
dtoa-benchmark
duckdb
duktape
dynet
easyexif
easyloggingpp
EasyOCR
EasyOCR-cpp
ecal
ECMA262
edit-distance
efftw
efsw
EigenRand
emphf-hash
enca
ensmallen
epeg
eventpp
EWAHBoolArray
exiv2
expected
expected-lite
exprtk
Extensible-Storage-Engine
extract
eytzinger
faiss
falconn
farmhash
farver-OKlab
fast-hex
fast-kmeans
fast-lzma2
fastapprox
fastBPE
fastfilter_cpp
FastGlobbing
fastgron
fasthashing
fastops
fastPRNG
fastrange
FastString
fastText
fast_double_parser
fast_float
fast_pfor
fatal
faup
fbow
fCWT
ffht
FFME
FFmpeg
ffts
fftw3
FiberTaskingLib
fifo_map
figcone
figtree
file
filesystem
FIt-SNE
fityk
flac
flann
flare-floss
flashlight
flat.hpp
flatton-offline
flat_hash_map
flinng
flip
fluent-bit
fluxsort
FM-fast-match
fmath
fmem
fmemopen_windows
fmt
fmtlog
fnmatch
folly
fontbm
fontconfig
fph-table
fpng
freeglut
freetype
fribidi
friso
frozen
fsst
fuzzy-match
fxt
g2o
g3log
gbenchmark
gcem
gdbm
gegl
gencolormap
genieclust
getopt
gettext
gflags
gibbs-lda
giflib-turbo
glaze
glfw
glib2
glm
glob
glog
glyph_name
gmic
gmic-community
GMM-HMM-kMeans
GMMreg
gmt
gnuplot
gnuplot-palettes
gnuplot_i
GoldFish-CBOR
google-diff-match-patch
googletest
gperf
GQ-gumbo-css-selectors
gram_savitzky_golay
graph-coloring
GraphBLAS
graphit
groonga
GSL
gtn
gtsam
guetzli
guile
gumbo-libxml
gumbo-parser
gumbo-query
gumbo_pp
h5cpp
Hackers-Delight
half
harbour-core
harfbuzz
harry
HashMap
hdbscan
hdbscan-cpp
HDiffPatch
hedley
hescape
highway
highwayhash
hikyuu
hilbert_curves
hilbert_hpp
hmm-scalable
hmm-stoch
hnswlib
hocr-fileformat
hocr-spec
hocr-tools
honggfuzz
hopscotch-map
houdini
hsluv-c

##############.NET######## html2openxml

htmlstreamparser
http-parser
hunspell
hunspell-hyphen
hydraquill
hyperscan
hypertextcpp
iceberghashtable
iceoryx
icer_compression
IconFontCppHeaders
id3-tagparser
ifopt
ikd-Tree
imagedistance
imagehash
Imath
indicators
InferenceHelper
infoware
InversePerspectiveMapping
iODBC
ion-c
Ipopt
iresearch
itcl
ITK
itpp
ivf-hnsw
JabRef-abbreviations
JabRef-Browser-Extension
JamSpell
jasper
jbig2dec
jemalloc
jerryscript
jimtcl
jpeg
jpeg-xl
jpeg2dct
jpeginfo
jq
json
jsoncons
jsoncpp
jtc
K-Medoids-Clustering
kahypar
kalman-cpp
kann
KDSPDSetup
kfr
kgraph
kissfft
kiwi
klib
knusperli
koan
krabsETW
krita
L1Flattening
lapack
LBFGS-Lite
lcms2
lda
lda-3-variants
lda-bigartm
LDCF-hash
learnopencv
leptonica
leptonica-hillshade
lerc
lexbor
libaco
libahocorasick
libalg
libaom
libarchive
libascii
libase
libass
libassert
libatlas
libavif
libbf
libbloom
libbloomfilters
libblosc
libboost-context
libboost-coroutine
libboost-fiber
libboost-filesystem
libboost-iostreams
libboost-locale
libboost-log
libboost-math
libboost-mpi
libboost-mpl
libboost-program_options
libboost-serialization
libboost-stacktrace
libboost-thread
libboost-wave
libboost_examples
libboost_tools
libbtree
libcbor
libchaos
libchardet
libchiaroscuramente
libCHM
libchopshop
libclip
libclipboard
libcluster
libcmime
libcnl
libconfig
libcopp
libcppjieba
libcpr
libcpuid
libCRCpp
libCSD
libcsp
libcsv2
libcuckoo
libcxxtest_catch2_2_gtest
libcyaml
libCZMQ
libde265
libdeflate
libdi-dependency-injection
libdiagnostics
libdip
libdist
libdivide
libdivsufsort
libdjvu
libdtm
libeigen
libenkiTaskScheduler
libeternaltimestamp
libevent
libevt
libexpat
libfamilia
libfann
libffi
libfolia
libfort
libfyaml
libgateY
libgd
libgif
libgnurx
libgrape-lite
libharry
libhashmapbtree
libheif
libheif-alt
libhilbert
libhog
libicns
libiconv
libics
libicu
libicu_tests
libicu_tools
libidn2
libimagequant
libinsane
libInterpolate
libintrinsics
libirwls
libjansson
libjpeg-turbo
libjpegqs
libjxl
libkdtree
libkra
liblbfgs
liblinear
libmarl
libmarl_tests
libmdbx
libmegamime
libmetalink
libmio
libmlpp
libmobi
libmodbus
libngt-ann
libnop
liboauth2
libocca
libpano13
libparameters
libpathutils
libpillowfight
libpinyin
libpipeline
libpmemobj-cpp
libpng
libpopcnt
libpostal
libprecog
libpromise
libpsd
libpsl
libq
libqrencode
libraqm
librobust-bibtex
librs232
librsync
libscanf
libserialport
libshmcache
libsigcplusplus
libsiridb
libsl3
libsmile
libsndfile
libsptag
libsql
libsqlfs
libstb
libstemmer
libsvgcharter
libsvm
libtbb
libtextcat
libtidyhtml
libtiff
libtoml
libtorch
libtuv
libucl
libuint128
libuint128_tests
libunibreak
libunifex
libupskirt
libusb
libuv
libvcopy
libvips
libvrb
libwarc
libwebp

########.NET####### libWebP.Net

libwebsocketpp
libwebsockets
libwil
libwildmatch
libxbr-standalone
libxcam
libxml2
libXMP-Toolkit
libxo
libxslt
libyaml
libyaml-examples
libzint
libzip
libzmq
libzopfli
lib_nas_lockfile
LightGBM
LightLDA
Lightning.NET
ligra-graph
linecook
linenoise
line_detector
lizard
LLhttp-parser
lmdb
lmdb-safe
lmdb-store
lmdb.spreads.net
lmdbxx
lmfit
LMW-tree
lnav
localmemcache
lockfree
loguru
lol
lolremez
lrucache11
lru_cache
lshbox
LSHBOX
LSWMS
lterpalettefinder
luple
lz4
lzham_codec
LZMA-Vizualizer
mace
magic_enum
magsac
mammut
manticore
manticore-columnar
manticore-plugins
mapreduce
marian
MariGold.OpenXHTML
mathtoolbox
matplotplusplus
mcmc
mcmc-jags
mcmd
mecab
mechascribe
MegEngine
memory
merror
mesh-allocator
messagebox-windows
mht-rip
MicroPather
microsoft-performance-toolkit-sdk
midas
mimalloc
mimetic
minhash_clustering
minifb
minimp3
miniscript
minizip-ng
mipp
MITIE-nlp
mitlm
mlinterp
mlpack
mmc
mmkv
MNN
modbus-esp8266
ModernCppStarter
monolith
morton_filter
mosquitto
mozjpeg
MPMCQueue
mrpt
ms_cpp_client_telemetry
mujs
Multicore-TSNE
MultipartEncoder
multiverso
mutable_rank_select
mxnet
mydumper
mysql-connector-cpp
n2-kNN
nameof
nano-signal-slot
nanodbc
nanoflann
nanoflann_dbscan
nanogui
NanoLog
nanomsg-nng
nanosvg
nanovg-qjs
nativefiledialog-extended
ncnn
nedtries
netpbm
neutralinoJS
neutralinoJS-CLI
newlisp
nfft
nghttp3
ngrams-weighted
ngtcp2
NiuTrans.NMT
nlopt
nlopt-util
nmslib
nodesoup
notcurses
npoi
nsis-nscurl
NSIS-OBSInstallerUtils
nsis-stdutils
NSISDotNetChecker
NSISFileCheck
NSISMultiUser
nsync
numero
nuspell
ocreval
ocr_eval_tools
OfficeIMO
oidn-OpenImageDenoise
oneDNN
online-hnsw
onnxruntime
onnxruntime-extensions
onnxruntime-genai
oof
open-vcdiff
Open-XML-SDK
openalpr
OpenBLAS
OpenCL-CTS
OpenCL-Headers
OpenCL-SDK
OpenColorIO
OpenCP
opencv
opencv_contrib
opencv_extra
OpenEXR
OpenFST
OpenFST-utils
OpenImageIO
openjpeg
openlibm
OpenNN
openpbs
openssl
opentelemetry-cpp
opentelemetry-cpp-contrib
openvino
oppat
optim
opus
or-tools
ormpp
osqp
osqp-cpp
osqp-eigen
osquery
OTB
otl
otl-ml
owl
OZBCBitmap
Paddle-Lite
PaddleClas
PaddleDetection
PaddleNLP
PaddleOCR
PaddlePaddle
pagerank
paintingReorganize
palanteer
palmtree
pango
papis-zotero
paramonte
pcg-c-random
pcg-cpp-random
pcl
pcm
pcre
pdf2htmlEX
PDFGen
pdfgrep
pdiff
pecos
PEGTL
pelikan
pevents
pfp-cst
PGM-index
pg_similarity
pHash
phash-gpl
phf-hash
photino.native
PhotonLibOS
picoc
picohttpparser
pico_tree
pikchr
Pillow
pillow-resize
pinyin
pipes
piposort
pisa
pisa_formatter
pixman
pke
PlatformFolders
plf_nanotimer
pmdk
pmdk-tests
pmemkv
pmemkv-bench
png-pmt-tools-lib
poco
podofo
poisson_blend
polatory
poplar-trie
portable-memory-mapping
portable-snippets
portable_concurrency-std-future
prio_queue
probminhash
promise-hpp
protobuf
proxygen
prvhash
psd_sdk
pthread-win32
pthread-win32-EH
pthread-win32-JMP
pthread-win32-jumbo
pthreadpool
puffinn
pybind11
pyclustering
pyglass
pylene
pytorch_cluster
pytorch_cpp_demo
QALSH
QALSH_Mem
QCBOR
qHilbert
qjs-ffi
qjs-modules
qjs-opencv
qjs-sqlite3
qlever
qoa
qoi
qs_parse
quadsort
Quant
QuantLib
quantum
QuickJS
QuickJS-C++-Wrapper
QuickJS-C++-Wrapper2
quickjs-ffi
quill-logging
quirc
r8brain-free-src
radamsa
radon-tf
ragel
RAKE
randen
random
random-forest
RandomizedRedundantDCTDenoising
RapidFuzz
rapidJSON
rapidxml
rapidyaml
rclone
RE-flex
re2
re2c
readerwriterqueue
reckless
RectangleBinPack
recycle
refl-cpp
replxx
reproc
restc-cpp
result-cpp
resumable-assert
retinex
rgf
riegeli
RNGSobol
RoaringBitmap
robin-hood-hashing
robin-map
robotstxt
rollinghashcpp
rotate
rotate_detection
RRD
RRPN
rsync
rtl
rttr
RuntimeCompiledCPlusPlus
ruy
RxCpp
sac
safeclib
safestringlib
salieri
sally
sbcl
scantailor
scilab
scintilla
ScriptX
scws-chinese-word-segmentation
sdhash
sdsl-lite
Sealighter
see-phit
semimap
sent2vec
sentence-tokenizer
sentencepiece
sequential-line-search
serde-cpp
serdepp
shadesmar
ShapeCrawler
sharedhashfile
SheenBidi
Sherwood
Shifted-Hamming-Distance
shmdata
shoco
Signals
sile-typesetter
silk-codec
silk-v3-decoder
SilkETW
simd-imgproc
simdcomp
simdjson
SIMDString
simhash-cpp
sioyek
SipHash
sist2
slot_map
smhasher
snap
snappy
snmalloc
snowball
Solo
somoclu
Sophus
sparsehash
sparsepp
spdlog
spdlog_setup
spdlog_sqlite_sink
spdmon
speex
spherical-k-means
spline
splinter
splitmerge
spookyhash
SPSCQueue
spy-build-sysinfo
sqawk
sqlcipher
sqlean
sqleet
sqlite
sqlite-amalgamation
sqlite-fts5-snowball
sqlite-parquet-vtable
sqlite-stats
sqlite3-compression-encryption-vfs
sqlite3pp
SQLiteCpp
SQLiteHistograms
sqliteodbc
sqlite_fts_tokenizer_chinese_simple
sqlite_wrapper
sqlite_zstd_vfs
sqlplot-tools
sqlpp11
squash
ssdeep
sse-popcount
ssimulacra2
stan
stan-math
StarSpace
state-threads
stateline
stats
statsite
stdext-path
stlcache
stringi
strings2
StringZilla
StronglyUniversalStringHashing
strtk
stx-error-handling
subprocess
subprocess-cpp
subprocess_h
SuiteSparse
sumatrapdf
SuperString
swig
SymSpell
SymspellCPP
SZ
SZ3
tab
tabulate
taglib
tao-json
taolog
tapkee
taskflow
tcl
tclap
tclclockmod
tcllib
tcpshm
tcp_pubsub
tee-win32
telegram-bot-api
telegram-td
TelemetrySourcerer
tensorflow
tensorflow-docs
tensorflow-io
tensorflow-text
tensorstore
termcolor
tesseract
tesseract-gImgRdrGui
tesslinesplit
text-wrangler
textflowcpp
theoretica
thread-pool
thread-pool-c
thread-pool-cpp
ThreadPool
thrift
thunderSVM
ticpp
tink
tink-cc
tinn
tiny-dnn
tiny-process-library
tiny-utf8
tinycbor
tinycolormap
tinydir
tinyexpr
tinyexr
tinygettext
tinynurbs
tinyspline
tlsh
tlx
tlx-btree
tmap
TNN
toml11
TraceETW
tracelogging-for-ETW
transwarp
tray
tre
treelite
trng4
tsf
tvision
twain_library
tweeny
txiki.js
typesense
u8g2
u8_to_std_string
uberlogger
uchardet
ucto
uctodata
ucx
ugrep
unblending
unicode-cldr
unilib
units
universal-numbers
unixODBC
uno-solver
unpaper
unqlite
unsmear
upscaledb
upskirt
URI-Encode-C
url
URL-Detector
url-parser
usearch
userver
utf8proc
utfcpp
uvw
variadic_table
velocypack
Verify
VisualScriptEngine
vizzu
vmaf 
vmem
vmemcache
VQMT
VSNASM
VTK
vtm
vxl
waifu2x-ncnn-vulkan
warc2text
warp-ctc
warpLDA
wavelib
wcwidth9
wdenoise
we-love-colors
websocket-sharp
webview
wget
wget2
wil-Win32-Interface-Library
win-iconv
win32-dpi
Win32_read_directory_changes
Win32_read_directory_changes_IOCP
Windows10EtwEvents
winflexbison
WinHttpPAL
WinToast
wolfsort
word2vec
word2vec-GloVe
worde_butcher
wxCharts
wxCurl
wxDatabase
wxExamples
wxFormBuilder
wxMEdit
wxPdfDocument
wxPDFView
wxSQLite3
wxVisualScriptEngine
wxWebViewChromium
wxWidgets
wyhash
xbrzscale
xcdat
xdelta
xgboost
xlnt
xml-pugixml
xmunch
xnnpack
xor-and-binary-fuse-filter
Xoshiro-cpp
xpdf
xsg
xsimd
xsldbg
xtensor
xtensor-blas
xtensor-io
xtl
xxHash
YACLib
yake
yaml-cpp
yaml-test-suite
yara-pattern-matcher
yasl
yggdrasil-decision-forests
you-token-to-me
yyjson
yy_color_convertor
zfp-compressed-arrays
zlibxtensor
ZLMediaKit
zpp_bits
ZQCNN
zstd
zsv
zsync2
zvec
zxing-cpp

EOT
) | grep -e "$FILTER"
)

# Anything that will end up as an application, even when regarded from our monolithic buil perspective

myapplist=$(
(
grep -v '#' <<EOT

bbe
bebop
bin2cpp
binary_bakery
calibre
capnproto
cpplocate
cryptest
EtwExplorer
ex-leptonica-freetype-harfbuzz
filecopyex3
fontview
FreeFileSync
fswatch
gnuplot
gperf
GraphicsMagick
grok-jpeg2000
horsejs
IdGenerator
ImageMagick
jbig2enc
jpegview
loki
lzbench
manticore
mcmd
metalink-cli
metalink-mini-downloader
netdata
nsis
ogdf
olena
omaha
p7zip
pikchr
png-pmt-tools
qpdf
radamsa
ragel
remake

# sdcc

sdcc
siridb-server
sumatrapdf
tempo
text-wrangler
thrift
tidyhtml
tray
UIforETW
vcopy
vcpkg
visible-url-detector
WebView2Browser
WebView2Samples

EOT
) | grep -e "$FILTER"
)

# Anything else, that's not really code we'll be incorporating in the form of a library or application. Data, documentation, etc.:

misclist=$(
(
grep -v '#' <<EOT

archive-hocr-tools
awesome-c
Awesome-Document-Image-Rectification
Awesome-Image-Quality-Assessment
calibre
citation-abbreviations
citation-journals
citation-styles
citeproc-js
ColorPaletteCodable
curl-www
DocLayNet
doxygen-awesome-css
everything-curl
hsluv-color-gradient
html5lib-tests
hunspell-dictionaries
IMGUR5K-Handwriting-Dataset
ipa-dict
javascript-serialization-benchmark
langdata_LSTM
LeptonicaDocsSite
libprecog-data
libprecog-manuals
local_adaptive_binarization
many-stop-words
MetBrewer
mupdf_explored
openexr-images
PNWColors
podofo
preprocess-corpuses
pyclustering
Sancho.Panza.on.tesseract.OCR
stopwords
tensorflow-docs
tessconfigs
tessdata
tessdata_best
tessdata_contrib
tessdata_fast
tessdoc
tesseract-dev-mailing-list-archive
tesseract-ocr-mailing-list-archive
tesseract_api_docs
tesseract_docs
tesseract_langdata
tesseract_ocr_test
tesstrain
unicode-cldr-data
unicode-icu-data
unicode-icu-demos
UnofficialLeptDocs
wesanderson
wordfreq
wordfrequency

EOT
) | grep -e "$FILTER"
)

# projects which use names different from their actual storage directory; see also update-cvxproj.js script's mapping table:

deletelist=$(
grep -v '#' <<EOT

bibtex-robust-decoder
c-blosc2
cef-pdf
CHM-lib
cpp-btree
cryptopp
cxxtest_catch_2_gtest
drogon
enkiTS-TaskScheduler
google-marl
gperf-hash
h2o-server
json-jansson
lda-Familia
libchm_io
libdjvulibre
libdjvu_io
libdtldiff
libgdiff
libhdiff
liboiio
libQuickJSpp
libQuickJSpp2
libquill
manticoresearch
math-atlas
mime-mega
oiio
oneTBB
OptimizationTemplateLibrary
parallel-hashmap
pdfium
pmt-png-tools
poppler
promise-cpp
pytorch
svg-charter
tidy-html5
tomlpp
uberlog
uint128_t
unicode-icu
upskirt-markdown
XMP-Toolkit-SDK
zotero
zotero-better-bibtex
zotero-bib
zotero-build
zotero-connectors
zotero-google-docs-integration
zotero-libreoffice-integration
zotero-scholar-citations
zotero-shortdoi
zotero-standalone-build
zotero-translate
zotero-translation-server
zotero-translators
zotero-web-library
zotero-word-for-windows-integration
zotero-zotfile

EOT
)

deletelist2=$(
grep -v '#' <<EOT

libYACLib
libnmslib
libhnswlib
libsafestringlib
libCacheLib

EOT
)


if false ; then
	echo "--------------------------------------------------"
	echo "mylist=$mylist"
	echo "--------------------------------------------------"
	echo "myapplist=$myapplist"
	echo "--------------------------------------------------"
	echo "misclist=$misclist"
	echo "--------------------------------------------------"
	echo "deletelist=$deletelist"
	echo "--------------------------------------------------"
	echo "deletelist=$deletelist2"
	echo "--------------------------------------------------"
fi


if [ "$FILTER" = "." ] ; then
	WILDCARD="*"
else
	WILDCARD="*$FILTER*"
fi


# debugging:
if false ; then
	echo "FILTER: $FILTER"
	echo "WILDCARD: $WILDCARD"
	echo "ARG: $ARG"
fi


if [[ "$ARG" =~ [1] ]] ; then
	for f in  $mylist  ; do
		#if ( shopt -s nocasematch ; [[ $f =~ $FILTER ]] ) ; then
			mknewproj $f
		#fi
	done
fi

if [[ "$ARG" =~ [2] ]] ; then
	for f in  $myapplist  ; do
		#if ( shopt -s nocasematch ; [[ $f =~ $FILTER ]] ) ; then
			mknewAPPproj $f
		#fi
	done

	for f in  $misclist  ; do
		#if ( shopt -s nocasematch ; [[ $f =~ $FILTER ]] ) ; then
			mknewMISCproj $f
		#fi
	done
fi

if [[ "$ARG" =~ [12] ]] ; then
	# and only now do we add all those generated project files to the overview solution!
	# we do this brute-force by simply adding ALL projects to that solution again; the next
	# load by Visual Studio will clean up the .sln file for us.
	echo "augment MSVC solution 'm-dev-list.sln' by adding all known *$FILTER* projects..."
	(
		for f in $( ls *.vcxproj | tr -d '\r' | grep -i -e "$FILTER" ) ; do
			node ./mk_project_line_for_sln.js $f
		done
	) >> m-dev-list.sln
fi

if [[ "$ARG" =~ [3] ]] ; then
	for f in $( ls *.vcxproj | tr -d '\r' | grep -i -e "$FILTER" ) ; do
		echo "Updating $f..."
		./update-vcxproj.sh $f
	done
fi

if [[ "$ARG" =~ [4] ]] ; then
	for f in $( ls *.vcxproj | tr -d '\r' | grep -i -e "$FILTER" ) ; do
		echo "Refilling $f..."
		./refill-vcxproj.sh $f
	done
fi

if [[ "$ARG" =~ [0] ]] ; then
	for f in  $deletelist  ; do
	  delnewproj $f
	done
	for f in  $deletelist2  ; do
	  delnewproj2 $f
	done
fi

